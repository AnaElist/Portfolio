
## В этом разделе представлены задания для оценки навыков работы с SQL, выполненные для медицинского центра. 

Для каждого задания сначала приводится подробное описание задачи, а затем – SQL-запрос, реализующий требуемую логику.

### Описание данных

В заданиях используются данные из таблиц FACT_COMMERCIAL_STATS, DIM_ORG_STRUCTURE, DIM_SERV и DIM_EMPLOYEE. 

Таблица FACT_COMMERCIAL_STATS содержит транзакции пациентов
(
  -  DIM_PATIENTS_ID integer, -- ID пациента
  -  BILL_DATE date, -- дата транзакции
  -  REVENUE float, -- сумма транзакции
   - DIM_EMPLOYEE_ID integer, -- ID врача
   - DIM_ORG_STRUCTURE_ID integer, -- ID филиала клиники
   - DIM_SERV_ID integer -- ID услуги
);


Таблица DIM_EMPLOYEE содержит информацию о врачах
(
   -  DIM_EMPLOYEE_ID integer, -- ID врача
   -  FULL_NAME varchar(100), -- ФИО врача	
);


Таблица DIM_ORG_STRUCTURE содержит информацию о филиалах клиники
(
  -   DIM_ORG_STRUCTURE_ID integer, -- ID филиала клиники
   -  FILIAL varchar(100), -- название филиала
);


Таблица DIM_SERV содержит информацию об услугах клиники
(
  -   DIM_SERV_ID integer, -- ID услуги
  -   SERVICE_NAME varchar(100), -- название услуги
);

На основе описания данных была составлена схема БД. 

![DB_scheme](https://github.com/user-attachments/assets/49f25e0d-600c-44b1-9dd5-39a740f64cb8)

## Задания

**Задача 1:** 

Найдите сумму транзакций каждого пациента за 2023 год. Выведите id пациента, сумму всех его транзакций.


**Задача 2:** 

Для каждого врача в филиале  Отделение "Южное" выведите сумму выручки и количество приемов с 1 января 2024 по услуге Акция: Первичный прием. Знакомство с врачом. Выведите ФИО врача, выручку, количество приемов в порядке убывания выручки

 
**Задача 3:** 

Найдите пациентов, которые год не были на приеме у стоматолога в филиалах Отделение "Московское" и  Отделение "Северное". Выведите также для каждого пациента дату последнего приема у стоматолога 
 

**Задача 4:**

a)	Филиал Отделение "Обводный Канал". 
•	Найдите пациентов, которые год не были на приеме у гинеколога (вне зависимости, когда они делали УЗИ);
•	Найдите пациентов, которые не делали УЗИ больше года (вне зависимости, когда они были у гинеколога). Интересуют только УЗИ молочных желез, УЗИ щитовидной железы, УЗИ брюшной полости. 
•	Выведите общий список уникальных id пациентов

b)	Для пациентов из пункта a) выведите точку входа в клинику. Точка входа в данном случае – это дата первой транзакции, ФИО врача и название филиала в этой транзакции



## Используемые технологии

SQL, диалект PostgreSQL.
